<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Job Tracker - Job Capsule</title>
  <link rel="stylesheet" href="static/styles.css">
</head>
<body>
  <!-- Placeholder for the navbar -->
  <div id="navbar"></div>

  <main>
    <!-- Search Bar -->
    <div class="search-bar">
      <input type="text" id="search" placeholder="Search jobs...">
      <select id="filterStatus">
        <option value="all">All</option>
        <option value="applied">Applied</option>
        <option value="interview">Interview</option>
        <option value="offer">Offer</option>
        <option value="rejected">Rejected</option>
      </select>
      <button onclick="filterJobs()">Search</button>
    </div>

    <!-- Job Listings -->
    <div class="job-listings" id="jobList">
      <!-- Jobs will be dynamically added here -->
    </div>
  </main>

  <footer>
    <p>Contact: info@careerhub.com | Phone: +1 234 567 890</p>
    <p><a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
  </footer>

  <script>
    // Fetch and inject the navbar
    fetch('navbar.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('navbar').innerHTML = data;

        // Highlight the active link
        const currentPage = window.location.pathname.split('/').pop();
        const activeLink = document.getElementById(`nav-${currentPage.replace('.html', '')}`);
        if (activeLink) {
          activeLink.classList.add('active');
        }
      });

    // Sample Data
    let jobs = [
      { id: 1, title: "Software Engineer", company: "Tech Corp", status: "applied" },
      { id: 2, title: "Product Manager", company: "Innovate Inc", status: "interview" },
      { id: 3, title: "Data Scientist", company: "DataWorks", status: "offer" },
    ];

    // Render Jobs
    function renderJobs(filteredJobs = jobs) {
      const jobList = document.getElementById('jobList');
      jobList.innerHTML = '';

      filteredJobs.forEach(job => {
        const jobCard = document.createElement('div');
        jobCard.classList.add('job-card');
        jobCard.innerHTML = `
          <h3>${job.title}</h3>
          <p>${job.company}</p>
          <p class="status ${job.status}">${job.status.toUpperCase()}</p>
        `;
        jobList.appendChild(jobCard);
      });
    }

    // Filter and Search Functionality
    function filterJobs() {
      const searchTerm = document.getElementById('search').value.toLowerCase();
      const statusFilter = document.getElementById('filterStatus').value;

      const filteredJobs = jobs.filter(job => {
        const matchesSearch = job.title.toLowerCase().includes(searchTerm) || job.company.toLowerCase().includes(searchTerm);
        const matchesStatus = statusFilter === 'all' || job.status === statusFilter;
        return matchesSearch && matchesStatus;
      });

      renderJobs(filteredJobs);
    }

    // Extract the search query from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const searchQuery = urlParams.get('search');

    // Pre-fill the search bar with the query from the homepage
    if (searchQuery) {
      document.getElementById('search').value = searchQuery;
    }

    // Initial Render (filter jobs based on the search query)
    filterJobs();
  </script>
</body>
</html>